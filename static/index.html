<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>tmp tes</title>
    <script>
        async function sendQuery() {
            const userInput = document.getElementById("user-text").value; // ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸°
            const userImage = document.getElementById("user-image").files[0]; // ì…ë ¥ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸°
            const responseBox = document.getElementById("result"); // ê²°ê³¼ ì¶œë ¥í•  ê³³

            if (!userInput.trim()) {
                responseBox.innerText = "ë³´ë‚¼ê°’ ì…ë ¥";
                return;
            }
            
            var formData = new FormData();
            formData.append("text", userInput);
            if (userImage) {
                formData.append("image", userImage);
            }

            console.log(formData.body);

            try {
                // Node.js ì„œë²„ë¡œ ë°ì´í„° ì „ì†¡
                const res = await fetch("http://localhost:3000/ask", {
                    method: "POST",
                    body : formData
                });

                const data = await res.json();
                console.log("success");
                responseBox.innerText = `LLM ì‘ë‹µ : ${data.llm_response}`;
            } catch (error) {
                console.error("[html] ë°ì´í„°ì „ì†¡ ì‹¤íŒ¨ : ", error);
            }
        }
    </script>
</head>
<body>
    <header id = "header">
        <div>Trashlyzer</div>
    </header>

    <div id = "main">
        <div id = "help-area">
            <div id = "help-title">
                <span><b>ğŸ’¡ë…¸ì›êµ¬ ëŒ€í˜• ì“°ë ˆê¸° ë¶„ë¦¬ë°°ì¶œ</b></span>
            </div>
            <div id = "help-text-area">
                <span id ="help-text">ì´ë¯¸ì§€ë¥¼ ì…ë ¥ í›„, ìš”ì²­ì‚¬í•­ì„ ì‘ì„±í•˜ë©´ ëŒ€í˜• ì“°ë ˆê¸° ì²˜ë¦¬ë¹„ìš©ì„ ì•Œì•„ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤!</span>
            </div>
        </div>

        <!-- ì‚¬ìš©ìì™€ ìƒí˜¸ì‘ìš© í•˜ëŠ” ê³µê°„-->
        <div id = "content-containers">
            <!-- gpt ì‘ë‹µì´ ë“¤ì–´ê°ˆ ê³µê°„-->
            <div id = "answer-content-container">
                <div id ="answer-title">
                    ë‹µë³€
                </div>
                <div id = "gpt-answer-text">
                    <p id="result">ê²°ê³¼ í‘œì‹œë˜ëŠ” ê³³</p>
                </div>
            </div>
            
            <div id = "user-input-containers">
                <!-- ì´ë¯¸ì§€ ì„ íƒ ì¹´ë“œ UI-->
                <div id = "user-image-container">
                    <label for = "user-image">
                        ëŒ€í˜• ì“°ë ˆê¸° ì´ë¯¸ì§€ ì„ íƒ
                        <div><input type="file" id="user-image" placeholder="ëŒ€í˜• ì“°ë ˆê¸° ì´ë¯¸ì§€ ì„ íƒ"></div>                       
                    </label>
                    <div id = "user-image-help">ì—¬ëŸ¬ë¶„ë“¤ì˜ ì´ë¯¸ì§€ëŠ” ë³´í˜¸ë©ë‹ˆë‹¤! ì €ì¥ ì—†ì´ ì§„í–‰ë©ë‹ˆë‹¤.</div>
                </div>
                <!-- ìœ ì € í…ìŠ¤íŠ¸ ì…ë ¥ ì¹´ë“œ UI-->
                <div id = "user-text-containers">
                    <div id = "user-input-help">
                        ğŸ˜€ëŒ€í˜•ì“°ë ˆê¸° ì´ë¯¸ì§€ì™€ í•¨ê»˜ ì „ë‹¬í•˜ê³  ì‹¶ì€ ë‚´ìš©ì„
                        ì‘ì„±í•´ì£¼ì„¸ìš”!
                    </div>
                    <div id = "user-text-input-container">
                        <input type="text" id="user-text" placeholder="í…ìŠ¤íŠ¸ ì…ë ¥">
                        <button onclick="sendQuery()">â†‘</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</head>
</html>